{% extends "admin_layout.html" %}

{% block title %}Destinasi{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h3 class="card-title">ğŸ—ºï¸ Daftar Destinasi</h3>
        <button class="btn btn-primary" onclick="alert('Fitur tambah destinasi coming soon!')">+ Tambah
            Destinasi</button>
    </div>
    <table>
        <thead>
            <tr>
                <th>Destinasi</th>
                <th>Tipe</th>
                <th>Status</th>
                <th>Kapasitas</th>
                <th>Cuaca</th>
                <th>Aksi</th>
            </tr>
        </thead>
        <tbody>
            {% for dest in destinations %}
            <tr>
                <td>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <img src="{{ dest.image_url }}" alt="{{ dest.name }}"
                            style="width: 50px; height: 50px; object-fit: cover; border-radius: 8px;">
                        <div>
                            <div style="font-weight: 600;">{{ dest.name }}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">{{ dest.description[:40] }}...
                            </div>
                        </div>
                    </div>
                </td>
                <td>
                    {% if dest.type == 'alam' %}
                    <span class="badge badge-success">ğŸŒ¿ Alam</span>
                    {% elif dest.type == 'budaya' %}
                    <span class="badge badge-primary">ğŸ­ Budaya</span>
                    {% else %}
                    <span class="badge badge-warning">ğŸ—ï¸ Buatan</span>
                    {% endif %}
                </td>
                <td>
                    {% if dest.status == 'open' %}
                    <span class="badge badge-success">âœ“ Buka</span>
                    {% elif dest.status == 'closed' %}
                    <span class="badge badge-danger">âœ— Tutup</span>
                    {% else %}
                    <span class="badge badge-warning">ğŸ”§ Maintenance</span>
                    {% endif %}
                </td>
                <td>
                    {% set percentage = (dest.current_visitors / dest.capacity * 100) | int %}
                    <div style="font-size: 13px;">{{ dest.current_visitors }}/{{ dest.capacity }}</div>
                    <div class="capacity-meter" style="width: 80px;">
                        <div class="capacity-fill {% if percentage < 50 %}low{% elif percentage < 80 %}medium{% else %}high{% endif %}"
                            style="width: {{ percentage }}%;"></div>
                    </div>
                </td>
                <td style="font-size: 13px;">{{ dest.weather_info or '-' }}</td>
                <td>
                    <button class="btn btn-outline btn-sm">Edit</button>
                    <form action="{{ url_for('toggle_destination_status', destination_id=dest.id) }}" method="POST"
                        style="display: inline;">
                        {% if dest.status == 'open' %}
                        <button type="submit" class="btn btn-danger btn-sm">Tutup</button>
                        {% else %}
                        <button type="submit" class="btn btn-success btn-sm">Buka</button>
                        {% endif %}
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" style="text-align: center; color: var(--text-secondary);">Belum ada destinasi</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Facilities Section -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">ğŸš» Fasilitas</h3>
    </div>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        {% for facility in facilities %}
        <div style="background: rgba(0,0,0,0.02); padding: 15px; border-radius: 10px;">
            <div style="font-size: 24px; margin-bottom: 8px;">
                {% if facility.type == 'toilet' %}ğŸš»{% elif facility.type == 'parking' %}ğŸ…¿ï¸{% elif facility.type ==
                'mushola' %}ğŸ•Œ{% else %}ğŸª{% endif %}
            </div>
            <div style="font-weight: 500;">{{ facility.name }}</div>
            <div style="font-size: 12px; color: var(--text-secondary);">{{ facility.type | capitalize }}</div>
        </div>
        {% else %}
        <div style="color: var(--text-secondary);">Belum ada fasilitas terdaftar</div>
        {% endfor %}
    </div>
</div>
{% endblock %}